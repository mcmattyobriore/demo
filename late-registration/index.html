<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">

  <title>Late Registration</title>

  <link id="favicon" rel="icon" href="./favicon.png" />

  <link rel="apple-touch-icon" href="./favicon.png">

  <meta name="apple-mobile-web-app-title" content="Yeezy Night Funkinâ€™">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      background: black;
    }

    body {
      padding-top: env(safe-area-inset-top);
      padding-bottom: env(safe-area-inset-bottom);
      padding-left: env(safe-area-inset-left);
      padding-right: env(safe-area-inset-right);
    }

    canvas {
      display: block;
      width: 100vw;
      height: 100vh;
    }

    #musicButton {
      position: absolute;
      top: calc(env(safe-area-inset-top) + 10px);
      right: calc(env(safe-area-inset-right) + 10px);
      background: none;
      border: none;
      cursor: pointer;
      padding: 0;
      transition: transform 0.2s ease;
      z-index: 999;
    }

    #musicButton:hover {
      transform: scale(1.2);
    }

    #musicButton img {
      width: 64px;
      height: 64px;
      display: block;
    }
  </style>
</head>

<body>

<button id="musicButton">
  <img id="musicIcon" src="./shared/images/ui/music-muted.png" alt="Music Button">
</button>

<canvas id="funkin"></canvas>

<script>
  const tracks = [
    "./shared/songs/heard-em-say.mp3",
    "./shared/songs/late.mp3",
    "./shared/songs/roses.mp3",
    "./shared/songs/touch-the-sky.mp3",
    "./shared/songs/we-major.mp3"
  ];

  let isPlaying = false;
  let currentAudio = null;

  const button = document.getElementById("musicButton");
  const icon = document.getElementById("musicIcon");

  function playRandomTrack() {
    if (!isPlaying) return;

    const randomIndex = Math.floor(Math.random() * tracks.length);
    const track = tracks[randomIndex];

    if (currentAudio) {
      currentAudio.pause();
      currentAudio = null;
    }

    currentAudio = new Audio(track);
    currentAudio.volume = 1;
    currentAudio.play();

    currentAudio.onended = () => {
      playRandomTrack();
    };
  }

  button.addEventListener("click", () => {
    isPlaying = !isPlaying;

    if (isPlaying) {
      icon.src = "./shared/images/ui/music-on.png";
      playRandomTrack();
    } else {
      icon.src = "./shared/images/ui/music-muted.png";
      if (currentAudio) {
        currentAudio.pause();
        currentAudio = null;
      }
    }
  });
</script>

<script>
  const demo = {
    objects: [
      { name: "floor-light1", image: "./shared/images/objects/floor-lights/behind.png", x: -380, y: -200, scale: 0.8, layer: 3 },
      { name: "floor-light2", image: "./shared/images/objects/floor-lights/front.png", x: -380, y: -200, scale: 0.8, layer: 3 },
      { name: "lamp-lightend", image: "./shared/images/objects/lamp/lightened.png", x: -380, y: -200, scale: 0.8, layer: 3 },
      { name: "lamp-light", image: "./shared/images/objects/lamp/light.png", x: -380, y: -200, scale: 0.8, layer: 1 },
      { name: "lamp", image: "./shared/images/objects/lamp/lamp.png", x: -380, y: -200, scale: 0.8, layer: 2 },
      { name: "registrationsign", image: "./shared/images/objects/secret/secret.png", x: -380, y: -200, scale: 0.8, layer: 1 },
      { name: "registrationsign", image: "./shared/images/objects/postage/fixedregistrationsign.png", x: -380, y: -200, scale: 0.8, layer: 1 },
      { name: "background", image: "./shared/images/finalbackground.png", x: -380, y: -200, scale: 0.8, layer: 0 },
      { name: "opponent", image: "./shared/images/opponent.png", xml: "./shared/xml/opponent.xml", x: 150, y: 350, scale: 1, layer: 1 },
      { name: "player", image: "./shared/images/player.png", xml: "./shared/xml/player.xml", x: 650, y: 450, scale: 0.25, layer: 1 }
    ]
  };
</script>

<script src="./funkin.js"></script>

</body>
</html>
